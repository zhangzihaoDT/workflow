好的，我给你画一个清晰的 **CM2 纯电/增程占比推断流程图**，把你提到的四个对照组整合进去，展示它们在整体推断中的作用。

---

```
                        ┌─────────────────────────┐
                        │        数据准备          │
                        │ CM1全量纯电用户          │
                        │ CM2全量混合用户          │
                        │ CM2小样本标签用户 (30%)  │
                        └──────────┬──────────────┘
                                   │
                                   ▼
                 ┌─────────────────────────────────┐
                 │ 1️⃣ 数据清洗与特征工程           │
                 │ - 性别、年龄、城市、区域编码     │
                 │ - One-hot + 数值标准化           │
                 └──────────┬──────────────────────┘
                            │
                            ▼
           ┌─────────────────────────────────────────┐
           │ 2️⃣ 小样本监督建模 (核心)                │
           │ 使用 CM2 小样本标签训练分类器/概率模型   │
           │ 预测全量 CM2 用户的纯电/增程概率        │
           │ (对照组4: 小样本纯电 vs 增程差异)       │
           └──────────┬─────────────────────────────┘
                      │
                      ▼
 ┌───────────────────────────────────────────────┐
 │ 3️⃣ 分布校准 / 代表性修正                     │
 │ - 对照组2: 小样本 vs CM2全量，计算特征偏差    │
 │ - 使用重要性加权 / 分层校准修正预测概率       │
 └──────────┬────────────────────────────────────┘
            │
            ▼
 ┌───────────────────────────────────────────────┐
 │ 4️⃣ 参考对照与验证                             │
 │ - 对照组1: CM1 vs CM2全量特征差异            │
 │ - 对照组3: CM2小样本纯电 vs CM1全量纯电差异 │
 │ → sanity check，确保预测合理                 │
 └──────────┬────────────────────────────────────┘
            │
            ▼
 ┌───────────────────────────────┐
 │ 5️⃣ 输出结果                    │
 │ - CM2 全量纯电占比              │
 │ - CM2 全量增程占比              │
 │ - 可分城市/性别/年龄层的占比    │
 └───────────────────────────────┘
```

---

### 🔹 核心思路总结

1. **小样本标签**是核心监督信息（区分纯电/增程）
2. **小样本 vs 全量**用于校准权重，保证小样本代表性
3. **CM1 纯电分布**作为纯电参考做 sanity check
4. **最终输出**是全量 CM2 占比和特征分层占比

---

如果你希望，我可以再帮你 **写一个 Python 半监督 EM + 校准的实现示例**，把这四个对照组的数据都用上，直接得出 CM2 全量纯电/增程占比。

你希望我写吗？
